<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>IPython and matplotlib in knitr - Fabian's Website</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href="https://0x0b.de/favicon.ico" rel="icon">

<link rel="canonical" href="https://0x0b.de/ipython-and-matplotlib-in-knitr.html">

        <meta name="author" content="Fabian Hirschmann" />
        <meta name="keywords" content="knitr,ipython,python,matplotlib" />
        <meta name="description" content="I&#39;ve been very pleased with knitr when writing dynamic documents for the web or in LaTeX. As I&#39;m both an R and Python fan, I often found myself wanting to write Python code in knitr. However, the Python engine in knitr is quite basic and doesn&#39;t support ..." />

        <meta property="og:site_name" content="Fabian's Website" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="IPython and matplotlib in knitr"/>
        <meta property="og:url" content="https://0x0b.de/ipython-and-matplotlib-in-knitr.html"/>
        <meta property="og:description" content="I&#39;ve been very pleased with knitr when writing dynamic documents for the web or in LaTeX. As I&#39;m both an R and Python fan, I often found myself wanting to write Python code in knitr. However, the Python engine in knitr is quite basic and doesn&#39;t support ..."/>
        <meta property="article:published_time" content="2015-01-26" />
            <meta property="article:section" content="misc" />
            <meta property="article:tag" content="knitr" />
            <meta property="article:tag" content="ipython" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="matplotlib" />
            <meta property="article:author" content="Fabian Hirschmann" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://0x0b.de/theme/css/bootstrap.yeti.min.css" type="text/css"/>
    <link href="https://0x0b.de/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://0x0b.de/theme/css/pygments/monokai.css" rel="stylesheet">
    <link rel="stylesheet" href="https://0x0b.de/theme/css/style.css" type="text/css"/>


        <link href="https://0x0b.de/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Fabian's Website ATOM Feed"/>



        <link href="https://0x0b.de/feeds/misc.atom.xml" type="application/atom+xml" rel="alternate"
              title="Fabian's Website misc ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://0x0b.de/" class="navbar-brand">
Fabian's Website            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="https://0x0b.de/pages/about-me.html">
                             About Me
                          </a></li>
                         <li><a href="https://0x0b.de/pages/projects.html">
                             Projects
                          </a></li>
                         <li><a href="https://0x0b.de/pages/publications.html">
                             Publications
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://0x0b.de/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://0x0b.de/ipython-and-matplotlib-in-knitr.html"
                       rel="bookmark"
                       title="Permalink to IPython and matplotlib in knitr">
                        IPython and matplotlib in knitr
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-01-26T03:20:00+01:00"> Mon 26 January 2015</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://0x0b.de/tag/knitr.html">knitr</a>
        /
	<a href="https://0x0b.de/tag/ipython.html">ipython</a>
        /
	<a href="https://0x0b.de/tag/python.html">python</a>
        /
	<a href="https://0x0b.de/tag/matplotlib.html">matplotlib</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>I've been very pleased with knitr when writing dynamic documents for the web
or in LaTeX. As I'm both an R and Python fan, I often found myself wanting
to write Python code in knitr. However, the Python engine in knitr is quite
basic and doesn't support workspace-like environments such that variables
declared in one chunk are available in the next. Plus it doesn't support
matplotlib either.</p>
<p>Hence, I've started working on a new addon project to knitr named <a href="http://github.com/fhirschmann/knitron">knitron</a>
which provides both of these features to the former.</p>
<p>Knitron works by lazily starting a global IPython kernel the first time a code
chunk gets rendered by knitr and this kernel is reused for all consecutive chunks. This way
all the computation done in any previous chunk is available in the current chunk,
providing R-like behaviour for Python. This basically allows you to do
something like</p>
<div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>


<p>in one chunk and access it in the next:</p>
<div class="highlight"><pre><span class="n">x</span>
</pre></div>


<div class="highlight"><pre>## 5
</pre></div>


<p>All this is achieved by a <a href="https://github.com/fhirschmann/knitron/blob/master/inst/python/knitron.py">Python wrapper</a>
that sends the chunk to the existing IPython kernel and returns the output in JSON,
which in turn is then passed back to knitr.</p>
<p>As far as matplotlib is concerned, the wrapper script checks the pylab state machine
for any plots that the user might have created in a chunk. If this check turns
out positive, the images are written to files and passed back to knitr. This works
for both markdown and latex, as matplotlib supports either output format.</p>
<p>So, here's a nice plot:</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk unnamed-chunk-4" src="https://0x0b.de/figure/ipython-in-knitr/unnamed-chunk-4-1.png" /> </p>
<p>Thus far most of the image functions that knitr provided are supported,
including <code>fig.width</code> and <code>fig.height</code>.</p>
<p>In order to install knitron, the only thing to do is:</p>
<div class="highlight"><pre><span class="kn">library</span><span class="p">(</span>devtools<span class="p">)</span>
install_github<span class="p">(</span><span class="s">&quot;knitron&quot;</span><span class="p">,</span> <span class="s">&quot;fhirschmann&quot;</span><span class="p">)</span>
</pre></div>


<p>Knitron is not on CRAN yet, but hopefully will be soon! It can be
found on <a href="http://github.com/fhirschmann/knitron">Github</a>.</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = '0x0b'; // required: replace example with your forum shortname

                    var disqus_identifier = 'ipython-and-matplotlib-in-knitr';
                var disqus_url = 'https://0x0b.de/ipython-and-matplotlib-in-knitr.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
	<div class="container">
		<hr>
		<div class="row">
			<div class="col-xs-10">&copy; 2009 – 2015 Fabian Hirschmann
				&middot; <a href="https://0x0b.de/pages/legal-notice.html">legal notice</a>
				&middot; <a href="https://0x0b.de/pages/datenschutzerklarung.html">privacy statement</a>			</div>
			<div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
		</div>
		<div class="row pull-right">
			<ul class="list-group" id="social">
				<li class="list-group-item"><a href="https://github.com/fhirschmann"><i class="fa fa-github fa"></i> Github</a></li>
				<li class="list-group-item"><a href="mailto:fabian@hirschmann.email"><i class="fa fa-pencil fa"></i> Mail</a></li>
				<li class="list-group-item"><a href="http://www.facebook.com/fhirschmann"><i class="fa fa-facebook fa"></i> Facebook</a></li>
				<li class="list-group-item"><a href="http://www.linkedin.com/in/fhirschmann"><i class="fa fa-linkedin fa"></i> LinkedIn</a></li>
				<li class="list-group-item"><a href="https://www.xing.com/profile/Fabian_Hirschmann2"><i class="fa fa-xing fa"></i> Xing</a></li>
				<li class="list-group-item"><a href="bitcoin:16Mhwr5U9JVvVLEGwyPqyR1WE8qaJtzsin"><i class="fa fa-bitcoin fa"></i> BTC</a></li>
			</ul>
		</div>
	</div>
</footer>
<script src="https://0x0b.de/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://0x0b.de/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://0x0b.de/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = '0x0b'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->

</body>
</html>